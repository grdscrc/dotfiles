function httpless {
  # `httpless example.org'
  http --pretty=all --print=hb "$@" | less -R;
}

function mkcd {
  mkdir "$@" && cd "$@";
}

function choose {
  # Simple lunch location decider. Separate possibilities with ','
  # From https://twitter.com/climagic
  randomized_choices=$(echo "$@" | tr ',' '\n' | gshuf)

  head -1 $randomized_choices
}

function deploy {
	if [ -z "$1" ] || [ -z "$2" ]; then # Less than 2 parameters
		echo "Usage : deploy <rails|php> <staging|integration|production> [<branch>] [--migrate]"
		return 0
	fi

	language=$1
	env=$2
	
	if [ "$language" = "php" ] && [ "$env" = "staging" ]; then
		env=stage
	fi

	if [ -z "$3" ]; then
		branch="$(git rev-parse --abbrev-ref HEAD)"
	else
		branch=$3
	fi

	action=deploy
	if [ "$4" = "--migrate" ]; then
		action=$action\:migrations
	fi

	set -x

	case "$language" in
		rails)
			cap $env $action -S branch=$branch
			;;
		php)
			./deploy.sh $env $branch
			;;
	esac
}

function swop {
  if [ $# -ne 2 ]; then # Less than 2 parameters
    >&2 echo "Usage : swop <regex to replace> <replacement>"
    return 0
  fi

  ack -l "$1" | xargs perl -pi -E "s/$1/$2/g";
}

function hush {
  $@ 2> /dev/null
}
